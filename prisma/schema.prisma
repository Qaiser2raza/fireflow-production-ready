generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model audit_logs {
  id            String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String?      @db.Uuid
  staff_id      String?      @db.Uuid
  action_type   String       @db.VarChar(50)
  entity_type   String       @db.VarChar(50)
  entity_id     String?      @db.Uuid
  details       Json?
  ip_address    String?      @db.Inet
  created_at    DateTime?    @default(now()) @db.Timestamp(6)
  restaurants   restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  staff         staff?       @relation(fields: [staff_id], references: [id], onUpdate: NoAction)
}

model customers {
  id              String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id   String               @db.Uuid
  name            String?              @db.VarChar(100)
  phone           String               @db.VarChar(20)
  address         String?
  notes           String?
  created_at      DateTime?            @default(now()) @db.Timestamp(6)
  updated_at      DateTime?            @default(now()) @db.Timestamp(6)
  restaurants     restaurants          @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  delivery_orders delivery_orders[]
  orders          orders[]
  takeaway_orders takeaway_orders[]
  addresses       customer_addresses[]

  @@unique([restaurant_id, phone])
}

model customer_addresses {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  customer_id  String    @db.Uuid
  label        String    @db.VarChar(50) // "Home", "Office", etc.
  full_address String
  landmarks    String?
  is_default   Boolean   @default(false)
  created_at   DateTime? @default(now()) @db.Timestamp(6)
  customers    customers @relation(fields: [customer_id], references: [id], onDelete: Cascade)
}

model delivery_orders {
  id                        String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id                  String     @unique @db.Uuid
  customer_name             String?
  customer_phone            String
  delivery_address          String?
  customer_id               String?    @db.Uuid
  driver_id                 String?    @db.Uuid
  dispatched_at             DateTime?
  current_lat               Decimal?   @db.Decimal(10, 8)
  current_lng               Decimal?   @db.Decimal(11, 8)
  delivered_at              DateTime?
  delivery_duration_minutes Int?
  failed_reason             String?
  last_location_update      DateTime?
  customers                 customers? @relation(fields: [customer_id], references: [id])
  staff                     staff?     @relation(fields: [driver_id], references: [id])
  orders                    orders     @relation(fields: [order_id], references: [id])
}

model dine_in_orders {
  id                  String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id            String   @unique @db.Uuid
  table_id            String   @db.Uuid
  guest_count         Int
  guest_count_history Json?
  waiter_id           String?  @db.Uuid
  seated_at           DateTime @default(now())
  orders              orders   @relation(fields: [order_id], references: [id])
  tables              tables   @relation(fields: [table_id], references: [id])
  staff               staff?   @relation(fields: [waiter_id], references: [id])
}

model expenses {
  id            String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String?      @db.Uuid
  description   String       @db.VarChar(100)
  amount        Decimal      @db.Decimal(10, 2)
  category      String       @db.VarChar(50)
  date          DateTime?    @default(now()) @db.Timestamp(6)
  staff_id      String?      @db.Uuid
  restaurants   restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  staff         staff?       @relation(fields: [staff_id], references: [id], onUpdate: NoAction)
}

model installation_logs {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  installer_id String?   @db.Uuid
  device_id    String?   @db.VarChar(100)
  status       String    @db.VarChar(50)
  notes        String?
  created_at   DateTime? @default(now()) @db.Timestamp(6)
  staff        staff?    @relation(fields: [installer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model license_keys {
  id              String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id   String?      @db.Uuid
  license_key     String       @unique @db.VarChar(100)
  is_active       Boolean?     @default(false)
  activated_at    DateTime?    @db.Timestamp(6)
  expires_at      DateTime?    @db.Timestamp(6)
  license_type    String?      @default("STANDARD") @db.VarChar(50)
  device_limit    Int?         @default(1)
  last_checked_at DateTime?    @db.Timestamp(6)
  restaurants     restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model menu_categories {
  id            String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String       @db.Uuid
  name          String       @db.VarChar(50)
  name_urdu     String?      @db.VarChar(50)
  priority      Int          @default(0)
  created_at    DateTime     @default(now())
  restaurants   restaurants  @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  menu_items    menu_items[]

  @@unique([restaurant_id, name])
}

model menu_items {
  id              String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id   String?          @db.Uuid
  name            String           @db.VarChar(100)
  name_urdu       String?          @db.VarChar(100)
  description     String?
  cost_price      Decimal?         @db.Decimal(10, 2)
  price           Decimal          @db.Decimal(10, 2)
  category        String           @db.VarChar(50)
  image_url       String?
  created_at      DateTime?        @default(now()) @db.Timestamp(6)
  is_available    Boolean?         @default(true)
  station         String?          @default("KITCHEN") @db.VarChar(20)
  track_stock     Boolean?         @default(false)
  daily_stock     Int?             @default(0)
  category_id     String?          @db.Uuid
  station_id      String?          @db.Uuid
  requires_prep   Boolean          @default(true)
  menu_categories menu_categories? @relation(fields: [category_id], references: [id])
  restaurants     restaurants?     @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  stations        stations?        @relation(fields: [station_id], references: [id])
  order_items     order_items[]
}

model order_items {
  id                   String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id             String      @db.Uuid
  menu_item_id         String      @db.Uuid
  quantity             Int
  unit_cost            Decimal?    @db.Decimal(10, 2)
  unit_price           Decimal     @db.Decimal(10, 2)
  total_price          Decimal     @db.Decimal(10, 2)
  station              String?
  started_at           DateTime?
  completed_at         DateTime?
  served_at            DateTime?
  special_instructions String?
  modifications        Json?
  item_name            String?
  category             String?
  created_at           DateTime    @default(now())
  station_id           String?     @db.Uuid
  predicted_ready_time DateTime?
  force_ready_at       DateTime?
  force_ready_by       String?     @db.Uuid
  item_status          ItemStatus? @default(PENDING)
  menu_items           menu_items  @relation(fields: [menu_item_id], references: [id])
  orders               orders      @relation(fields: [order_id], references: [id])
  stations             stations?   @relation(fields: [station_id], references: [id])
}

model orders {
  id                                     String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id                          String              @db.Uuid
  total                                  Decimal             @default(0) @db.Decimal(10, 2)
  items                                  Json?
  table_id                               String?             @db.Uuid
  guest_count                            Int?
  customer_name                          String?
  customer_phone                         String?
  delivery_address                       String?
  is_proforma_printed                    Boolean             @default(false)
  assigned_waiter_id                     String?             @db.Uuid
  assigned_driver_id                     String?             @db.Uuid
  created_at                             DateTime            @default(now())
  updated_at                             DateTime            @default(now())
  last_action_at                         DateTime?           @default(now())
  last_action_by                         String?
  last_action_desc                       String?
  service_charge                         Decimal?            @default(0) @db.Decimal(10, 2)
  delivery_fee                           Decimal?            @default(0) @db.Decimal(10, 2)
  tax                                    Decimal?            @default(0) @db.Decimal(10, 2)
  discount                               Decimal?            @default(0) @db.Decimal(10, 2)
  breakdown                              Json?
  cancelled_at                           DateTime?
  cancelled_by                           String?
  cancellation_reason                    String?
  cancellation_notes                     String?
  voided_at                              DateTime?
  voided_by                              String?
  void_reason                            String?
  void_notes                             String?
  refund_transaction_id                  String?
  rider_shift_id                         String?             @db.Uuid
  sync_status                            String              @default("PENDING")
  customer_id                            String?             @db.Uuid
  order_number                           String?             @unique @db.VarChar(20)
  payment_status                         PaymentStatus?      @default(UNPAID)
  predicted_complete_time                DateTime?
  bottleneck_detected                    Boolean             @default(false)
  force_settled_at                       DateTime?
  force_settled_by                       String?             @db.Uuid
  status                                 OrderStatus?        @default(ACTIVE)
  type                                   OrderType
  closed_at                              DateTime?
  completed_at                           DateTime?
  delivery_orders                        delivery_orders?
  dine_in_orders                         dine_in_orders?
  order_intelligence                     order_intelligence?
  order_items                            order_items[]
  rider_shift                            rider_shifts?       @relation(fields: [rider_shift_id], references: [id])
  staff_orders_assigned_driver_idTostaff staff?              @relation("orders_assigned_driver_idTostaff", fields: [assigned_driver_id], references: [id])
  staff_orders_assigned_waiter_idTostaff staff?              @relation("orders_assigned_waiter_idTostaff", fields: [assigned_waiter_id], references: [id])
  customers                              customers?          @relation(fields: [customer_id], references: [id])
  restaurants                            restaurants         @relation(fields: [restaurant_id], references: [id])
  tables                                 tables?             @relation(fields: [table_id], references: [id])
  reservation_orders                     reservation_orders?
  takeaway_orders                        takeaway_orders?
  transactions                           transactions[]

  @@index([assigned_driver_id])
  @@index([assigned_waiter_id])
  @@index([restaurant_id])
  @@index([table_id])
}

model order_intelligence {
  id                      String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id                String    @unique @db.Uuid
  predicted_complete_time DateTime?
  bottleneck_detected     Boolean   @default(false) @map(" bottleneck_detected")
  force_settled_at        DateTime?
  force_settled_by        String?   @db.Uuid
  created_at              DateTime  @default(now())
  updated_at              DateTime  @default(now())
  orders                  orders    @relation(fields: [order_id], references: [id], onDelete: Cascade)
}

model pairing_codes {
  id                   String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id        String               @db.Uuid
  pairing_code         String               @db.VarChar(10)
  hashed_code          String               @db.VarChar(100)
  created_at           DateTime             @default(now()) @db.Timestamp(6)
  expires_at           DateTime             @default(dbgenerated("(now() + '00:15:00'::interval)")) @db.Timestamp(6)
  is_used              Boolean              @default(false)
  used_by              String?              @db.Uuid
  verified_fingerprint String?
  attempt_count        Int                  @default(0)
  restaurants          restaurants          @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  registered_devices   registered_devices[]

  @@unique([restaurant_id, pairing_code])
  @@index([expires_at])
  @@index([restaurant_id])
}

model registered_devices {
  id                 String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id      String         @db.Uuid
  staff_id           String         @db.Uuid
  device_name        String         @db.VarChar(100)
  device_fingerprint String         @db.VarChar(255)
  user_agent         String?
  platform           String?        @db.VarChar(50)
  auth_token_hash    String         @db.VarChar(100)
  is_active          Boolean        @default(true)
  last_sync_at       DateTime?
  pairing_code_id    String?        @db.Uuid
  created_at         DateTime       @default(now()) @db.Timestamp(6)
  updated_at         DateTime       @db.Timestamp(6)
  pairing_codes      pairing_codes? @relation(fields: [pairing_code_id], references: [id], onUpdate: NoAction)
  restaurants        restaurants    @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  staff              staff          @relation(fields: [staff_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([restaurant_id, staff_id, device_fingerprint])
  @@index([is_active])
  @@index([restaurant_id])
  @@index([staff_id])
}

model reservation_orders {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id         String   @unique @db.Uuid
  customer_name    String
  customer_phone   String
  table_id         String?  @db.Uuid
  guest_count      Int      @default(2)
  reservation_time DateTime
  arrival_status   String   @default("PENDING")
  orders           orders   @relation(fields: [order_id], references: [id])
  tables           tables?  @relation(fields: [table_id], references: [id])
}

model reservations {
  id               String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id    String?      @db.Uuid
  customer_name    String       @db.VarChar(100)
  customer_phone   String?      @db.VarChar(20)
  table_id         String?      @db.VarChar(50)
  reservation_time DateTime     @db.Timestamp(6)
  guests           Int?         @default(2)
  status           String?      @default("PENDING") @db.VarChar(20)
  created_at       DateTime?    @default(now()) @db.Timestamp(6)
  restaurants      restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model restaurants {
  id                     String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                   String
  slug                   String?              @unique
  owner_id               String?
  phone                  String?
  address                String?
  currency               String?              @default("PKR")
  timezone               String?              @default("Asia/Karachi")
  is_active              Boolean              @default(true)
  subscription_status    String               @default("trial")
  subscription_plan      String               @default("BASIC")
  created_at             DateTime             @default(now())
  updated_at             DateTime             @default(now())
  monthly_fee            Decimal?             @db.Decimal(10, 2)
  tax_enabled            Boolean              @default(false)
  tax_rate               Decimal              @default(0) @db.Decimal(5, 2)
  service_charge_enabled Boolean              @default(false)
  service_charge_rate    Decimal              @default(5) @db.Decimal(5, 2)
  default_delivery_fee   Decimal              @default(250) @db.Decimal(10, 2)
  default_guest_count    Int                  @default(2)
  default_rider_float    Decimal              @default(5000) @db.Decimal(10, 2)
  audit_logs             audit_logs[]
  customers              customers[]
  expenses               expenses[]
  license_keys           license_keys[]
  menu_categories        menu_categories[]
  menu_items             menu_items[]
  orders                 orders[]
  pairing_codes          pairing_codes[]
  registered_devices     registered_devices[]
  reservations           reservations[]
  sections               sections[]
  staff                  staff[]
  stations               stations[]
  tables                 tables[]
  transactions           transactions[]
  vendors                vendors[]
  ledger_entries         ledger_entries[]
  payouts                payouts[]
  cash_sessions          cash_sessions[]
  rider_shifts           rider_shifts[]

  @@index([slug])
}

model rider_settlements {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id      String    @db.Uuid
  driver_id          String    @db.Uuid
  start_time         DateTime
  end_time           DateTime?
  amount_collected   Decimal   @db.Decimal(10, 2)
  amount_expected    Decimal   @db.Decimal(10, 2)
  amount_handed_over Decimal   @db.Decimal(10, 2)
  shortage           Decimal   @default(0) @db.Decimal(10, 2)
  status             String    @default("COMPLETED")
  processed_by       String?   @db.Uuid
  notes              String?
  created_at         DateTime  @default(now())
  staff              staff     @relation(fields: [driver_id], references: [id])
}

model rider_shifts {
  id                    String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id         String      @db.Uuid
  rider_id              String      @db.Uuid
  opened_by             String      @db.Uuid
  closed_by             String?     @db.Uuid
  opened_at             DateTime    @default(now()) @db.Timestamp(6)
  closed_at             DateTime?   @db.Timestamp(6)
  opening_float         Decimal     @default(0) @db.Decimal(10, 2)
  closing_cash_received Decimal?    @db.Decimal(10, 2)
  expected_cash         Decimal?    @db.Decimal(10, 2) // Opening Float + âˆ‘ Deliveries
  cash_difference       Decimal?    @db.Decimal(10, 2)
  status                String      @default("OPEN") @db.VarChar(20)
  notes                 String?
  orders                orders[]
  restaurants           restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
  rider                 staff       @relation("rider_shifts", fields: [rider_id], references: [id])
}

model sections {
  id            String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String?      @db.Uuid
  name          String       @db.VarChar(50)
  name_urdu     String?      @db.VarChar(50)
  prefix        String?      @default("T") @db.VarChar(10)
  priority      Int?         @default(0)
  type          String       @default("DINING") @db.VarChar(20)
  restaurants   restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tables        tables[]

  @@unique([restaurant_id, name])
}

model security_events {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id   String?   @db.Uuid
  event_type      String    @db.VarChar(50)
  severity        String    @db.VarChar(20)
  description     String?
  created_at      DateTime? @default(now()) @db.Timestamp(6)
  is_resolved     Boolean?  @default(false)
  acknowledged_by String?   @db.Uuid
  alert_sent_at   DateTime? @db.Timestamp(6)
  staff           staff?    @relation(fields: [acknowledged_by], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model staff {
  id                                      String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id                           String               @db.Uuid
  name                                    String
  role                                    String
  pin                                     String
  hashed_pin                              String?
  image                                   String?
  status                                  String?              @default("active")
  active_tables                           Int?                 @default(0)
  last_login                              DateTime?
  created_at                              DateTime             @default(now())
  total_deliveries                        Int?                 @default(0)
  average_delivery_time_minutes           Int?
  current_lat                             Decimal?             @db.Decimal(10, 8)
  current_lng                             Decimal?             @db.Decimal(11, 8)
  is_available                            Boolean?             @default(true)
  audit_logs                              audit_logs[]
  delivery_orders                         delivery_orders[]
  dine_in_orders                          dine_in_orders[]
  expenses                                expenses[]
  installation_logs                       installation_logs[]
  orders_orders_assigned_driver_idTostaff orders[]             @relation("orders_assigned_driver_idTostaff")
  orders_orders_assigned_waiter_idTostaff orders[]             @relation("orders_assigned_waiter_idTostaff")
  registered_devices                      registered_devices[]
  rider_settlements                       rider_settlements[]
  rider_shifts                            rider_shifts[]       @relation("rider_shifts")
  security_events                         security_events[]
  restaurants                             restaurants          @relation(fields: [restaurant_id], references: [id])
  staff_wallet_logs                       staff_wallet_logs[]

  @@unique([restaurant_id, name, role])
  @@index([pin])
  @@index([restaurant_id])
}

model staff_wallet_logs {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String   @db.Uuid
  staff_id      String   @db.Uuid
  amount        Decimal  @db.Decimal(10, 2)
  action_type   String
  reference_id  String?  @db.Uuid
  notes         String?
  created_by    String?  @db.Uuid
  created_at    DateTime @default(now())
  staff         staff    @relation(fields: [staff_id], references: [id], onDelete: Cascade)
}

model stations {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String        @db.Uuid
  name          String        @db.VarChar(50)
  is_active     Boolean       @default(true)
  created_at    DateTime      @default(now())
  menu_items    menu_items[]
  order_items   order_items[]
  restaurants   restaurants   @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)

  @@unique([restaurant_id, name])
}

model tables {
  id                 String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id      String               @db.Uuid
  name               String
  section_id         String?              @db.Uuid
  capacity           Int                  @default(4)
  active_order_id    String?
  status             String               @default("AVAILABLE")
  x_position         Int?
  y_position         Int?
  shape              String?
  merge_id           String?
  is_virtual         Boolean              @default(false)
  virtual_type       String?
  created_at         DateTime             @default(now())
  updated_at         DateTime             @default(now())
  dine_in_orders     dine_in_orders[]
  orders             orders[]
  reservation_orders reservation_orders[]
  restaurants        restaurants          @relation(fields: [restaurant_id], references: [id])
  sections           sections?            @relation(fields: [section_id], references: [id])

  @@unique([restaurant_id, name])
  @@index([restaurant_id])
  @@index([section_id])
}

model takeaway_orders {
  id                 String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id           String     @unique @db.Uuid
  token_number       String
  customer_name      String?
  customer_phone     String?
  pickup_time        DateTime?
  customer_id        String?    @db.Uuid
  actual_pickup_time DateTime?
  is_picked_up       Boolean?   @default(false)
  token_date         String?
  customers          customers? @relation(fields: [customer_id], references: [id])
  orders             orders     @relation(fields: [order_id], references: [id])

  @@unique([order_id, token_number])
}

model transactions {
  id              String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id   String?      @db.Uuid
  order_id        String?      @db.Uuid
  amount          Decimal      @db.Decimal(10, 2)
  payment_method  String       @db.VarChar(50)
  status          String       @db.VarChar(20)
  created_at      DateTime?    @default(now()) @db.Timestamp(6)
  transaction_ref String?      @db.VarChar(100)
  restaurants     restaurants? @relation(fields: [restaurant_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  orders          orders?      @relation(fields: [order_id], references: [id], onUpdate: NoAction)
}

model vendors {
  id            String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id String      @db.Uuid
  name          String      @db.VarChar(100)
  phone         String?     @db.VarChar(20)
  category      String      @db.VarChar(50)
  created_at    DateTime?   @default(now()) @db.Timestamp(6)
  restaurants   restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
}

enum ItemStatus {
  DRAFT
  PENDING
  PREPARING
  DONE
  SERVED
  SKIPPED
}

enum OrderStatus {
  ACTIVE
  READY
  DELIVERED  // New status: Order delivered, awaiting cash settlement
  CLOSED
  CANCELLED
  VOIDED
}

enum OrderType {
  DINE_IN
  TAKEAWAY
  DELIVERY
  RESERVATION
}

enum PaymentStatus {
  UNPAID
  PAID
  PARTIALLY_PAID
  REFUNDED
}

enum TableStatus {
  AVAILABLE
  OCCUPIED
  DIRTY
  CLEANING
  RESERVED
  OUT_OF_SERVICE
}

model ledger_entries {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id    String   @db.Uuid
  account_id       String?  @db.Uuid
  transaction_type String   @db.VarChar(10)
  amount           Decimal  @db.Decimal(10, 2)
  reference_type   String   @db.VarChar(50)
  reference_id     String?  @db.Uuid
  description      String?
  processed_by     String?  @db.Uuid
  created_at       DateTime @default(now()) @db.Timestamp(6)
  restaurants      restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
}

model payouts {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id    String   @db.Uuid
  amount           Decimal  @db.Decimal(10, 2)
  category         String   @db.VarChar(50)
  reference_id     String?  @db.Uuid
  notes            String?
  processed_by     String   @db.Uuid
  created_at       DateTime @default(now()) @db.Timestamp(6)
  restaurants      restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
}

model cash_sessions {
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  restaurant_id    String    @db.Uuid
  opened_by        String    @db.Uuid
  closed_by        String?   @db.Uuid
  opened_at        DateTime  @default(now()) @db.Timestamp(6)
  closed_at        DateTime? @db.Timestamp(6)
  opening_balance  Decimal   @default(0) @db.Decimal(10, 2)
  expected_balance Decimal?  @db.Decimal(10, 2)
  actual_balance   Decimal?  @db.Decimal(10, 2)
  variance         Decimal?  @db.Decimal(10, 2)
  status           String    @default("OPEN") @db.VarChar(20)
  notes            String?
  restaurants      restaurants @relation(fields: [restaurant_id], references: [id], onDelete: Cascade)
}
